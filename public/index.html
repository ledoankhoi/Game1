<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>MathQuest - Game Library</title>
    
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="css/main.css">

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#25f46a",
                        "background-light": "#f5f8f6",
                        "background-dark": "#102216",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        body { font-family: 'Lexend', sans-serif; }
        .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; }
        .card-hover:hover { transform: translateY(-4px); transition: transform 0.2s ease-in-out; cursor: pointer; }
        .hidden { display: none !important; }
        
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(4px);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .active-category {
            background-color: #25f46a !important; 
            color: white !important;
        }
        .active-category .material-symbols-outlined {
            color: white !important;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-[#111813] dark:text-white min-h-screen">

<div id="app-lobby" class="relative flex flex-col w-full">
    
    <header class="sticky top-0 z-50 w-full bg-white dark:bg-[#1a2e20] border-b border-[#e0e8e2] dark:border-[#2a3f31] px-6 py-3 flex items-center justify-between gap-4 shadow-sm h-20">
        
        <div class="flex items-center gap-3 cursor-pointer group shrink-0" onclick="window.location.href='index.html'">
            <div class="bg-primary p-2.5 rounded-2xl flex items-center justify-center shadow-lg shadow-green-500/20 group-hover:scale-105 transition-transform">
                <span class="material-symbols-outlined text-white text-3xl">calculate</span>
            </div>
            <h2 class="text-2xl font-black tracking-tighter text-gray-800 dark:text-white uppercase">
                Math<span class="text-primary">Quest</span>
            </h2>
        </div>

        <div class="flex-1 max-w-2xl px-4 lg:px-12">
    <form autocomplete="off" class="relative group w-full" onsubmit="return false;">
        
        <input type="email" name="fake_email_trap" style="position:fixed; top:-100px; left:-100px; opacity:0; pointer-events:none; height:0; width:0;" tabindex="-1">
        <input type="password" name="fake_password_trap" style="position:fixed; top:-100px; left:-100px; opacity:0; pointer-events:none; height:0; width:0;" tabindex="-1">
        <span class="absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none">
            <span class="material-symbols-outlined text-gray-400 group-focus-within:text-primary transition-colors text-2xl">search</span>
        </span>
        
        <input 
            id="search-input" 
            onkeyup="searchGames()" 
            type="search" 
            name="search_game_query_unique_v2" 
            autocomplete="off" 
            readonly="true" 
            onfocus="this.removeAttribute('readonly');"
            class="w-full pl-12 pr-4 py-3 bg-[#f0f5f1] dark:bg-[#0f1a14] border-2 border-transparent focus:bg-white dark:focus:bg-[#1a2e20] focus:border-primary/50 rounded-2xl text-base focus:ring-4 focus:ring-primary/10 transition-all shadow-inner placeholder-gray-400 text-gray-800 dark:text-white" 
            placeholder="Search for games..." 
        />
    </form>
</div>
        <div class="flex items-center gap-4 shrink-0">
            <div class="flex items-center gap-1 mr-2">
                <button onclick="window.location.href='leaderboard.html'" class="flex items-center gap-2 px-3 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-[#233829] text-gray-600 dark:text-gray-300 hover:text-yellow-600 transition-colors font-bold group" title="Leaderboard">
                    <span class="material-symbols-outlined text-xl group-hover:scale-110 transition-transform">emoji_events</span>
                    <span class="hidden lg:block">Rank</span>
                </button>

                <button onclick="MainApp.showShop()" class="flex items-center gap-2 px-3 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-[#233829] text-gray-600 dark:text-gray-300 hover:text-blue-600 transition-colors font-bold group" title="Item Shop">
                    <span class="material-symbols-outlined text-xl group-hover:scale-110 transition-transform">storefront</span>
                    <span class="hidden lg:block">Shop</span>
                </button>
            </div>

            <div class="h-8 w-px bg-gray-200 dark:bg-gray-700 hidden md:block"></div>
            
            <div id="header-guest" class="flex items-center gap-3">
                <button onclick="MainApp.showAuth()" class="text-sm font-bold text-gray-600 dark:text-gray-300 hover:text-primary transition-colors px-2">Log In</button>
                <button onclick="MainApp.showAuth()" class="bg-primary hover:bg-green-500 text-white text-sm font-bold px-5 py-2.5 rounded-xl shadow-lg shadow-green-500/30 transition-all transform active:scale-95 hover:-translate-y-0.5">Sign Up</button>
            </div>

            <div id="header-user" class="hidden flex items-center gap-6">
                <div class="bg-white dark:bg-[#0f1a14] border border-gray-100 dark:border-gray-700 pl-2 pr-4 py-1.5 rounded-full flex items-center gap-2 shadow-sm cursor-pointer hover:border-yellow-400 transition-colors" onclick="MainApp.showShop()">
                    <div class="bg-yellow-100 dark:bg-yellow-900/30 p-1 rounded-full">
                        <span class="material-symbols-outlined text-[#facc15] text-xl block">monetization_on</span>
                    </div>
                    <span class="text-sm font-black text-gray-800 dark:text-white tracking-wide"><span id="user-coin">0</span></span>
                </div>
                
                <div class="relative cursor-pointer group" onclick="window.location.href='userProfile.html'" title="Open Profile">
                    <svg class="w-14 h-14 -rotate-90 transform" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="46" stroke="currentColor" stroke-width="6" fill="transparent" class="text-gray-200 dark:text-gray-700" />
                        <circle id="level-progress-circle" cx="50" cy="50" r="46" stroke="currentColor" stroke-width="6" fill="transparent" class="text-[#25f46a] transition-all duration-1000 ease-out" stroke-dasharray="289" stroke-dashoffset="289" stroke-linecap="round" />
                    </svg>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <img id="user-avatar-img" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" class="w-10 h-10 rounded-full border-2 border-white dark:border-[#1a2e20] shadow-sm">
                    </div>
                    <div class="absolute -bottom-1 -right-1 bg-[#25f46a] text-white text-[10px] font-black w-5 h-5 flex items-center justify-center rounded-full border-2 border-white dark:border-[#1a2e20] shadow-md z-10">
                        <span id="user-level-badge">1</span>
                    </div>
                </div>
            </div>
        </div>


        
    </header>

    <main class="flex flex-1 flex-col lg:flex-row max-w-[1600px] mx-auto w-full p-4 lg:p-8 gap-8">
        
        <aside class="w-full lg:w-64 flex flex-col gap-8 shrink-0">
            <div class="flex flex-col gap-6">
                <section>
                    <h3 class="text-xs font-bold uppercase tracking-wider text-[#608a6e] mb-4">Danh m·ª•c</h3>
                    <div class="flex flex-col gap-2">
                        <button onclick="filterGames('all')" class="category-btn active-category flex items-center justify-between px-4 py-3 bg-white dark:bg-[#1a2e20] text-gray-600 dark:text-gray-300 hover:bg-[#f0f5f1] rounded-xl font-medium transition-all shadow-sm group" id="cat-all">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-lg">grid_view</span>
                                <span>T·∫•t c·∫£ game</span>
                            </div>
                            <span class="material-symbols-outlined text-sm opacity-0 group-[.active-category]:opacity-100">check_circle</span>
                        </button>

                        <button onclick="filterGames('logic')" class="category-btn flex items-center justify-between px-4 py-3 bg-white dark:bg-[#1a2e20] text-gray-600 dark:text-gray-300 hover:bg-[#f0f5f1] rounded-xl font-medium transition-all shadow-sm group" id="cat-logic">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-lg group-hover:text-primary transition-colors">psychology</span>
                                <span>Suy lu·∫≠n</span>
                            </div>
                        </button>

                        <button onclick="filterGames('math')" class="category-btn flex items-center justify-between px-4 py-3 bg-white dark:bg-[#1a2e20] text-gray-600 dark:text-gray-300 hover:bg-[#f0f5f1] rounded-xl font-medium transition-all shadow-sm group" id="cat-math">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-lg group-hover:text-primary transition-colors">calculate</span>
                                <span>T√≠nh to√°n</span>
                            </div>
                        </button>

                        <button onclick="filterGames('memory')" class="category-btn flex items-center justify-between px-4 py-3 bg-white dark:bg-[#1a2e20] text-gray-600 dark:text-gray-300 hover:bg-[#f0f5f1] rounded-xl font-medium transition-all shadow-sm group" id="cat-memory">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-lg group-hover:text-primary transition-colors">memory</span>
                                <span>Ghi nh·ªõ</span>
                            </div>
                        </button>

                        <button onclick="filterGames('speed')" class="category-btn flex items-center justify-between px-4 py-3 bg-white dark:bg-[#1a2e20] text-gray-600 dark:text-gray-300 hover:bg-[#f0f5f1] rounded-xl font-medium transition-all shadow-sm group" id="cat-speed">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-lg group-hover:text-primary transition-colors">bolt</span>
                                <span>T·ªëc ƒë·ªô</span>
                            </div>
                        </button>

                        <button onclick="filterGames('elite')" class="category-btn flex items-center justify-between px-4 py-3 bg-white dark:bg-[#1a2e20] text-gray-600 dark:text-gray-300 hover:bg-[#f0f5f1] rounded-xl font-medium transition-all shadow-sm group" id="cat-elite">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-lg text-yellow-500">emoji_events</span>
                                <span>Elite League</span>
                            </div>
                        </button>

                        <button onclick="filterGames('observation')" class="category-btn flex items-center justify-between px-4 py-3 bg-white dark:bg-[#1a2e20] text-gray-600 dark:text-gray-300 hover:bg-[#f0f5f1] rounded-xl font-medium transition-all shadow-sm group" id="cat-observation">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-lg group-hover:text-primary transition-colors">visibility</span>
                                <span>Quan s√°t</span>
                            </div>
                        </button>
                        
                        <button onclick="filterGames('endless')" class="category-btn flex items-center justify-between px-4 py-3 bg-white dark:bg-[#1a2e20] text-gray-600 dark:text-gray-300 hover:bg-[#f0f5f1] rounded-xl font-medium transition-all shadow-sm group" id="cat-endless">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-lg group-hover:text-primary transition-colors">all_inclusive</span>
                                <span>V√¥ t·∫≠n</span>
                            </div>
                        </button>

                    </div>
                </section>
            </div>
        </aside>

        <div class="flex-1 flex flex-col gap-10">
            
            <section class="relative h-[400px] w-full rounded-3xl overflow-hidden shadow-xl group">
                <img alt="Game of the Day" class="absolute inset-0 size-full object-cover transition-transform duration-500 group-hover:scale-105" src="https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=2000"/>
                <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent flex flex-col justify-end p-8 lg:p-12">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="bg-yellow-400 text-black text-[10px] font-black uppercase tracking-widest px-2 py-1 rounded-md">FEATURED</span>
                    </div>
                    <h1 class="text-4xl lg:text-6xl font-black text-white leading-tight max-w-2xl mb-4">Galaxy Striker:<br/>Math Defense</h1>
                    <p class="text-white/80 text-lg max-w-xl mb-8 leading-relaxed">Protect the galaxy from number monsters! Type the correct answer to shoot them down.</p>
                    <div class="flex items-center gap-4">
                        <button onclick="MainApp.startGame('monster')" class="bg-primary hover:bg-primary/90 text-white font-bold py-4 px-10 rounded-2xl shadow-lg transition-all active:scale-95 flex items-center gap-2">
                            <span class="material-symbols-outlined">play_circle</span> Play Now
                        </button>
                    </div>
                </div>
            </section>

            <section>
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center gap-3">
                        <div class="size-10 bg-orange-100 dark:bg-orange-900/30 rounded-xl flex items-center justify-center">
                            <span class="material-symbols-outlined text-orange-500">calculate</span>
                        </div>
                        <h2 class="text-2xl font-extrabold text-gray-800 dark:text-white">Popular Games</h2>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6" id="game-grid">
    
    <div class="game-card type-logic bg-white dark:bg-[#1a2e20] rounded-2xl overflow-hidden shadow-sm card-hover border border-[#e0e8e2] dark:border-[#2a3f31]" onclick="MainApp.startGame('sequence')">
        <div class="h-44 relative bg-gray-800">
            <img alt="Pattern Finder" class="size-full object-cover opacity-80" src="https://images.unsplash.com/photo-1620207418302-439b387441b0?q=80&w=600"/>
            <div class="absolute top-3 right-3 flex gap-1">
                <span class="bg-black/60 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Logic</span>
            </div>
        </div>
        <div class="p-5">
            <h4 class="font-bold text-lg mb-1 text-black dark:text-white">Pattern Finder</h4>
            <p class="text-sm text-[#608a6e] mb-5 line-clamp-2">Identify the missing sequence in a series of numbers.</p>
            <button class="w-full bg-[#f0f5f1] dark:bg-[#233829] hover:bg-primary hover:text-white text-[#111813] dark:text-white font-bold py-2.5 rounded-xl transition-all">Play Now</button>
        </div>
    </div>

    <div class="game-card type-speed type-math bg-white dark:bg-[#1a2e20] rounded-2xl overflow-hidden shadow-sm card-hover border border-[#e0e8e2] dark:border-[#2a3f31]" onclick="MainApp.startGame('speed')">
        <div class="h-44 relative bg-gray-800">
            <img alt="Speed Math" class="size-full object-cover opacity-80" src="https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=600"/>
            <div class="absolute top-3 right-3 flex gap-1">
                <span class="bg-black/60 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Speed</span>
                <span class="bg-blue-500/80 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Math</span>
            </div>
        </div>
        <div class="p-5">
            <h4 class="font-bold text-lg mb-1 text-black dark:text-white">Speed Math</h4>
            <p class="text-sm text-[#608a6e] mb-5 line-clamp-2">True or False? Decide quickly before time runs out!</p>
            <button class="w-full bg-[#f0f5f1] dark:bg-[#233829] hover:bg-primary hover:text-white text-[#111813] dark:text-white font-bold py-2.5 rounded-xl transition-all">Play Now</button>
        </div>
    </div>

    <div class="game-card type-math bg-white dark:bg-[#1a2e20] rounded-2xl overflow-hidden shadow-sm card-hover border border-[#e0e8e2] dark:border-[#2a3f31]" onclick="MainApp.startGame('monster')">
        <div class="h-44 relative bg-gray-800">
            <img alt="Galaxy Striker" class="size-full object-cover opacity-80" src="https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=600"/>
            <div class="absolute top-3 right-3 flex gap-1">
                <span class="bg-black/60 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Math</span>
            </div>
        </div>
        <div class="p-5">
            <h4 class="font-bold text-lg mb-1 text-black dark:text-white">Galaxy Striker</h4>
            <p class="text-sm text-[#608a6e] mb-5 line-clamp-2">Defeat math monsters in this action-packed shooter.</p>
            <button class="w-full bg-[#f0f5f1] dark:bg-[#233829] hover:bg-primary hover:text-white text-[#111813] dark:text-white font-bold py-2.5 rounded-xl transition-all">Play Now</button>
        </div>
    </div>

    <div class="game-card type-logic type-elite type-observation bg-white dark:bg-[#1a2e20] rounded-2xl overflow-hidden shadow-sm card-hover border border-[#e0e8e2] dark:border-[#2a3f31]" onclick="MainApp.startGame('pixel')">
        <div class="h-44 relative bg-gray-800 group overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-br from-gray-900 to-black flex items-center justify-center">
                <span class="material-symbols-outlined text-6xl text-gray-700 group-hover:text-primary transition-colors">view_comfy</span>
            </div>
            <div class="absolute top-3 right-3 flex gap-1">
                <span class="bg-black/60 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Logic</span>
                <span class="bg-black/60 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Obs</span>
                <span class="bg-yellow-500/80 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Elite</span>
            </div>
        </div>
        <div class="p-5">
            <h4 class="font-bold text-lg mb-1 text-black dark:text-white">Pixel Painting 3</h4>
            <p class="text-sm text-[#608a6e] mb-5 line-clamp-2">Mix colors and rotate layers to recreate the target image.</p>
            <button class="w-full bg-[#f0f5f1] dark:bg-[#233829] hover:bg-primary hover:text-white text-[#111813] dark:text-white font-bold py-2.5 rounded-xl transition-all">Play Now</button>
        </div>
    </div>

    <div class="game-card type-memory type-logic type-elite bg-white dark:bg-[#1a2e20] rounded-2xl overflow-hidden shadow-sm card-hover border border-[#e0e8e2] dark:border-[#2a3f31]" onclick="MainApp.startGame('maze')">
    <div class="h-44 relative bg-gray-800">
        <img alt="Maze Protocol" class="size-full object-cover opacity-80" src="https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=600"/>
        
        <div class="absolute top-3 right-3 flex gap-1">
            <span class="bg-black/60 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Memory</span>
            <span class="bg-black/60 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Logic</span>
            <span class="bg-yellow-500/80 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Elite</span>
        </div>
    </div>
    <div class="p-5">
        <h4 class="font-bold text-lg mb-1 text-black dark:text-white">Maze Protocol 01</h4>
        <p class="text-sm text-[#608a6e] mb-5 line-clamp-2">Synthesize 3 color-coded projections to navigate through invisible walls.</p>
        <button class="w-full bg-[#f0f5f1] dark:bg-[#233829] hover:bg-primary hover:text-white text-[#111813] dark:text-white font-bold py-2.5 rounded-xl transition-all">Play Now</button>
    </div>
</div>

<div class="game-card type-logic type-elite bg-white dark:bg-[#1a2e20] rounded-2xl overflow-hidden shadow-sm card-hover border border-[#e0e8e2] dark:border-[#2a3f31]" onclick="window.location.href='escape.html'">
    <div class="h-44 relative bg-gray-800">
        <img alt="Escape Strategy" class="size-full object-cover opacity-80" src="https://images.unsplash.com/photo-1616499370260-485b3e5ed653?q=80&w=600"/>
        
        <div class="absolute top-3 right-3 flex gap-1">
            <span class="bg-black/60 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Logic</span>
            <span class="bg-yellow-500/80 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold text-white uppercase">Elite</span>
        </div>
    </div>
    <div class="p-5">
        <h4 class="font-bold text-lg mb-1 text-black dark:text-white">Chi·∫øn Thu·∫≠t Tho√°t Hi·ªÉm 1</h4>
        <p class="text-sm text-[#608a6e] mb-5 line-clamp-2">ƒêi·ªÅu khi·ªÉn qu√¢n c·ªù tho√°t kh·ªèi m√™ cung 11x11 ƒë·∫ßy c·∫°m b·∫´y.</p>
        <button class="w-full bg-[#f0f5f1] dark:bg-[#233829] hover:bg-primary hover:text-white text-[#111813] dark:text-white font-bold py-2.5 rounded-xl transition-all">Play Now</button>
    </div>
</div>

            </section>
        </div>
    </main>
</div>

<section id="auth-screen" class="modal-overlay hidden">
    <div class="bg-white dark:bg-[#1a2e20] p-8 rounded-2xl w-full max-w-sm shadow-2xl relative">
        <button onclick="MainApp.hideAuth()" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 transition">
            <span class="material-symbols-outlined">close</span>
        </button>
        <h2 id="auth-title" class="text-2xl font-bold text-center mb-6 text-gray-800 dark:text-white">Login</h2>
        
        <div class="flex flex-col gap-3">
            <div id="group-username" class="hidden">
                <input type="text" id="reg-username" placeholder="Username" class="w-full px-4 py-3 rounded-xl border border-gray-300 dark:bg-gray-800 dark:text-white dark:border-gray-600 outline-none transition focus:ring-2 focus:ring-primary">
            </div>
            <input type="email" id="login-email" placeholder="Email Address" class="w-full px-4 py-3 rounded-xl border border-gray-300 dark:bg-gray-800 dark:text-white dark:border-gray-600 outline-none focus:ring-2 focus:ring-primary">
            <input type="password" id="login-password" placeholder="Password" class="w-full px-4 py-3 rounded-xl border border-gray-300 dark:bg-gray-800 dark:text-white dark:border-gray-600 outline-none focus:ring-2 focus:ring-primary">
        </div>

        <p id="auth-feedback" class="text-red-500 text-center text-sm mt-3 h-5 font-medium"></p>

        <button onclick="Auth.handleLogin(event)" id="btn-login" class="w-full bg-primary text-white font-bold py-3 rounded-xl mt-4 hover:bg-green-600 transition shadow-lg shadow-green-500/30 uppercase">Login</button>
        <button onclick="Auth.handleRegister(event)" id="btn-register" class="w-full bg-primary text-white font-bold py-3 rounded-xl mt-4 hidden hover:bg-green-600 transition uppercase shadow-lg shadow-green-500/30">Register</button>
        
        <p class="text-center text-sm mt-6 text-gray-500">
            <span id="text-switch">Don't have an account?</span> 
            <a href="#" onclick="toggleAuthMode()" class="text-primary font-bold hover:underline">Click here</a>
        </p>
    </div>
</section>

<section id="avatar-modal" class="modal-overlay hidden">
    <div class="bg-white dark:bg-[#1a2e20] w-full max-w-md rounded-3xl shadow-2xl p-6 relative border border-gray-100 dark:border-gray-700">
        <button onclick="UserProfile.closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 transition">
            <span class="material-symbols-outlined text-2xl">close</span>
        </button>
        <h2 class="text-2xl font-black text-center mb-2 text-gray-800 dark:text-white">Choose Avatar</h2>
        <p class="text-center text-sm text-gray-500 mb-6">Select your identity in the MathQuest universe.</p>
        <div id="avatar-grid" class="grid grid-cols-4 gap-4 justify-items-center max-h-[300px] overflow-y-auto p-2"></div>
        <div class="mt-6 text-center">
             <button onclick="UserProfile.closeModal()" class="bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 font-bold py-2 px-6 rounded-xl hover:bg-gray-200 transition">Cancel</button>
        </div>
    </div>
</section>

<div id="sound-float-btn" onclick="toggleSound(this)" class="fixed bottom-6 right-6 size-12 bg-white dark:bg-[#1a2e20] rounded-full shadow-lg flex items-center justify-center cursor-pointer hover:scale-110 transition z-50 border border-gray-200 dark:border-gray-700 text-2xl">üîä</div>

<script src="js/soundManager.js"></script>
<script src="js/auth.js"></script> 
<script src="js/userProfile.js"></script>
<script src="js/main.js"></script>
<script src="js/searchgame.js"></script>

<script>
    function toggleSound(btn) {
        if (typeof SoundManager !== 'undefined') {
            const icon = SoundManager.toggleMute();
            btn.innerText = icon;
        }
    }

    function toggleAuthMode() {
        const isLogin = !document.getElementById('btn-login').classList.contains('hidden');
        document.getElementById('auth-feedback').innerText = "";
        if (isLogin) {
            document.getElementById('auth-title').innerText = "Create Account";
            document.getElementById('btn-login').classList.add('hidden');
            document.getElementById('btn-register').classList.remove('hidden');
            document.getElementById('group-username').classList.remove('hidden');
            document.getElementById('text-switch').innerText = "Already have an account?";
        } else {
            document.getElementById('auth-title').innerText = "Login";
            document.getElementById('btn-login').classList.remove('hidden');
            document.getElementById('btn-register').classList.add('hidden');
            document.getElementById('group-username').classList.add('hidden');
            document.getElementById('text-switch').innerText = "Don't have an account?";
        }
    }

    function filterGames(category) {
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.classList.remove('active-category', 'bg-primary', 'text-white');
            btn.classList.add('bg-white', 'text-gray-600', 'dark:bg-[#1a2e20]', 'dark:text-gray-300');
            const check = btn.querySelector('.material-symbols-outlined:last-child');
            if(check && check.innerText === 'check_circle') check.remove();
        });

        const activeBtn = document.getElementById('cat-' + category);
        if (activeBtn) {
            activeBtn.classList.add('active-category', 'bg-primary', 'text-white');
            activeBtn.classList.remove('bg-white', 'dark:bg-[#1a2e20]');
            activeBtn.insertAdjacentHTML('beforeend', '<span class="material-symbols-outlined text-sm">check_circle</span>');
        }

        document.querySelectorAll('.game-card').forEach(game => {
            if (category === 'all' || game.classList.contains('type-' + category)) {
                game.classList.remove('hidden');
            } else {
                game.classList.add('hidden');
            }
        });
    }
</script>
</body>
</html>