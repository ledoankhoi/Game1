<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To√°n v√† Logic - C·ªïng Game</title>
    
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/game.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        .hidden { display: none !important; }
        .back-btn { cursor: pointer; }
        nav ul { display: flex; list-style: none; gap: 15px; }
        nav a { text-decoration: none; font-weight: bold; cursor: pointer; }
        /* CSS cho n√∫t Loa n·ªïi */
        #sound-float-btn {
            position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px;
            background: rgba(0, 0, 0, 0.6); border: 2px solid #00ffff; border-radius: 50%;
            color: #fff; font-size: 24px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; z-index: 9999; user-select: none; transition: 0.3s;
        }
        #sound-float-btn:hover { transform: scale(1.1); box-shadow: 0 0 15px #00ffff; }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">To√°n v√† Logic</div>
            <ul>
                <li><a href="#" onclick="MainApp.goHome()">Trang ch·ªß</a></li>
                <li><a href="#" onclick="MainApp.showLeaderboard()">X·∫øp h·∫°ng</a></li>
                <li><span style="color: yellow; font-weight: bold; margin-right: 10px;">üí∞ <span id="user-coin">0</span></span></li>
                <li><a href="#" onclick="MainApp.showShop()">C·ª≠a h√†ng</a></li>
                <li id="menu-auth"><a href="#" onclick="MainApp.showAuth()">ƒêƒÉng Nh·∫≠p</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="game-list" class="container">
            <h1>Ch·ªçn Tr√≤ Ch∆°i</h1>
            <div class="grid-games">
                <div class="game-card" onclick="MainApp.startGame('sequence')">
                    <h3>üî¢ Quy t·∫Øc chu·ªói s·ªë</h3>
                    <p>T√¨m quy lu·∫≠t v√† ƒëi·ªÅn s·ªë c√≤n thi·∫øu.</p>
                </div>
                <div class="game-card" onclick="MainApp.startGame('monster')">
                    <h3>üëæ Di·ªát Qu√°i To√°n H·ªçc</h3>
                    <p>G√µ nhanh ƒë√°p √°n ƒë·ªÉ ti√™u di·ªát qu√°i v·∫≠t!</p>
                </div>
                <div class="game-card" onclick="MainApp.startGame('speed')">
                    <h3>‚ö° Ph·∫£n X·∫° Th·∫ßn T·ªëc</h3>
                    <p>ƒê√∫ng hay Sai? Quy·∫øt ƒë·ªãnh trong t√≠c t·∫Øc!</p>
                </div>
            </div>
        </section>

        <section id="leaderboard-screen" class="game-area hidden">
            <div class="game-header">
                <button class="back-btn" onclick="MainApp.goHome()">‚Üê Quay l·∫°i</button>
                <h2>üèÜ B·∫£ng Phong Th·∫ßn üèÜ</h2>
            </div>
            <table border="1" style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                <thead>
                    <tr><th>H·∫°ng</th><th>Ng∆∞·ªùi ch∆°i</th><th>T·ªïng ƒëi·ªÉm</th></tr>
                </thead>
                <tbody id="leaderboard-body"></tbody>
            </table>
        </section>

        <section id="sequence-game-screen" class="game-area hidden">
            <button class="back-btn" onclick="SoundManager.play('click'); MainApp.goHome()">‚Üê Tho√°t</button>
            <h2>Quy t·∫Øc chu·ªói s·ªë</h2>
            <div id="sequence-content">
                <p>T√¨m s·ªë c√≤n thi·∫øu:</p>
                <div id="seq-display" class="sequence-box" style="font-size: 24px; font-weight: bold; margin: 20px 0;">Loading...</div>
                <div class="control-panel" style="margin-top: 15px; text-align: center;">
                    <input type="tel" id="seq-input" name="seq_random" autocomplete="off" placeholder="Nh·∫≠p s·ªë..." style="padding: 10px; width: 50%;">
                </div>
                <p id="seq-feedback"></p>
                <button onclick="SequenceGame.nextLevel()" class="next-btn" id="seq-next-btn" style="display:none;">C√¢u ti·∫øp theo</button>
            </div>
        </section>

        <section id="monster-game-screen" class="game-area hidden">
            <div class="game-header" style="display: flex; justify-content: space-between;">
                <button class="back-btn" onclick="SoundManager.play('click'); MainApp.goHome()">‚Üê Tho√°t</button>
                <div class="score-board">ƒêi·ªÉm: <span id="monster-score">0</span></div>
            </div>
            <div id="battlefield" style="height: 300px; background: rgba(0,0,0,0.3); position: relative; overflow: hidden; margin-top: 10px; border-radius: 10px;"></div>
            <div class="control-panel" style="margin-top: 15px; text-align: center;">
                <input type="tel" id="monster-input" name="monster_random" autocomplete="off" placeholder="Nh·∫≠p s·ªë..." style="padding: 10px; width: 50%;">
            </div>
            <div id="game-over-overlay" class="hidden" style="position: absolute; top: 100px; left: 0; right: 0; text-align: center; background: rgba(0,0,0,0.85); color: white; padding: 20px;">
                <h2>GAME OVER</h2>
                <button onclick="MonsterGame.start()">Ch∆°i l·∫°i</button>
            </div>
        </section>

        <section id="speed-game-screen" class="game-area hidden">
            <div class="game-header" style="display: flex; justify-content: space-between;">
                <button class="back-btn" onclick="MainApp.goHome()">‚Üê Tho√°t</button>
                <div class="score-board">ƒêi·ªÉm: <span id="speed-score">0</span></div>
            </div>
            <div style="width: 100%; height: 10px; background: #333; border-radius: 5px; margin-top: 10px; overflow: hidden;">
                <div id="time-bar" style="width: 100%; height: 100%; background: #00ffff; transition: width 0.1s linear;"></div>
            </div>
            <div id="speed-content" style="text-align: center; margin-top: 50px;">
                <h2 id="math-equation" style="font-size: 48px; color: #fff; text-shadow: 0 0 20px #00ffff;">Loading...</h2>
                <div style="display: flex; justify-content: center; gap: 50px; margin-top: 50px;">
                    <div style="text-align: center;">
                        <div style="font-size: 40px;">‚¨ÖÔ∏è</div>
                        <div style="color: #ff4757; font-weight: bold;">SAI</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 40px;">‚û°Ô∏è</div>
                        <div style="color: #2ecc71; font-weight: bold;">ƒê√öNG</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="shop-screen" class="game-area hidden">
            <div class="game-header">
                <button class="back-btn" onclick="MainApp.goHome()">‚Üê Quay l·∫°i</button>
                <h2>üõí C·ª≠a H√†ng V·∫≠t Ph·∫©m</h2>
            </div>
            <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-top: 20px;">
                <div class="shop-item" onclick="Shop.buy('default', 0)">
                    <div style="height: 100px; background: #000; border: 1px solid #fff;"></div>
                    <h3>V≈© Tr·ª• (G·ªëc)</h3><p>ƒê√£ s·ªü h·ªØu</p>
                </div>
                <div class="shop-item" onclick="Shop.buy('forest', 500)">
                    <div style="height: 100px; background: #2ecc71; border: 1px solid #fff;"></div>
                    <h3>R·ª´ng R·∫≠m</h3><p style="color: yellow;">üí∞ 500</p>
                </div>
                <div class="shop-item" onclick="Shop.buy('ice', 1000)">
                    <div style="height: 100px; background: #3498db; border: 1px solid #fff;"></div>
                    <h3>BƒÉng Gi√°</h3><p style="color: yellow;">üí∞ 1000</p>
                </div>
            </div>
            <p id="shop-msg" style="text-align: center; margin-top: 20px; font-weight: bold;"></p>
        </section>

        <section id="auth-screen" class="game-area hidden">
            <button class="back-btn" onclick="MainApp.goHome()">‚Üê Quay l·∫°i</button>
            <div class="auth-container" style="max-width: 400px; margin: 20px auto; padding: 20px;">
                <h2 id="auth-title" style="text-align: center;">ƒêƒÉng Nh·∫≠p</h2>
                
                <div class="input-group">
                    <div id="group-username" class="hidden">
                        <label>T√™n hi·ªÉn th·ªã:</label>
                        <input type="text" id="reg-username" placeholder="V√≠ d·ª•: HuyPro" style="width: 100%; margin-bottom: 10px;">
                    </div>
                    <label>Email:</label>
                    <input type="email" id="login-email" placeholder="email@example.com" style="width: 100%; margin-bottom: 10px;">
                    <label>M·∫≠t kh·∫©u:</label>
                    <input type="password" id="login-password" placeholder="******" style="width: 100%; margin-bottom: 10px;">
                </div>

                <p id="auth-feedback" style="color: #ff4757; text-align: center;"></p>

                <div class="action-buttons" style="text-align: center;">
                    <button onclick="Auth.handleLogin(event)" id="btn-login" style="background: #3498db;">ƒêƒÉng Nh·∫≠p</button>
                    <button onclick="Auth.handleRegister(event)" id="btn-register" class="hidden" style="background: #27ae60;">ƒêƒÉng K√Ω</button>
                </div>

                <p class="switch-mode" style="text-align: center; margin-top: 15px;">
                    <span id="text-switch">Ch∆∞a c√≥ t√†i kho·∫£n?</span> 
                    <a href="#" onclick="toggleAuthMode()">B·∫•m v√†o ƒë√¢y</a>
                </p>
            </div>
        </section>
    </main>

    <div id="sound-float-btn" onclick="toggleSound(this)">üîä</div>

    <script src="js/games/sequence.js"></script>
    <script src="js/games/monster.js"></script>
    <script src="js/games/speed.js"></script> 
    <script src="js/leaderboard.js"></script>
    <script src="js/shop.js"></script>
    <script src="js/main.js"></script>
    <script src="js/soundManager.js"></script>

    <script>
        function toggleSound(btn) {
            if (typeof SoundManager !== 'undefined') {
                const icon = SoundManager.toggleMute();
                btn.innerText = icon;
            }
        }
    </script>

    <script>
        function toggleAuthMode() {
            const isLogin = !document.getElementById('btn-login').classList.contains('hidden');
            const feedback = document.getElementById('auth-feedback');
            if(feedback) feedback.innerText = "";

            if (isLogin) {
                // Chuy·ªÉn sang ƒêƒÉng K√Ω
                document.getElementById('auth-title').innerText = "ƒêƒÉng K√Ω T√†i Kho·∫£n";
                document.getElementById('btn-login').classList.add('hidden');
                document.getElementById('btn-register').classList.remove('hidden');
                document.getElementById('group-username').classList.remove('hidden');
                document.getElementById('text-switch').innerText = "ƒê√£ c√≥ t√†i kho·∫£n?";
                
                // ƒê·ªïi ID ƒë·ªÉ l·∫•y d·ªØ li·ªáu d·ªÖ h∆°n
                document.getElementById('login-email').id = 'reg-email';
                document.getElementById('login-password').id = 'reg-password';
            } else {
                // Chuy·ªÉn v·ªÅ ƒêƒÉng Nh·∫≠p
                document.getElementById('auth-title').innerText = "ƒêƒÉng Nh·∫≠p";
                document.getElementById('btn-login').classList.remove('hidden');
                document.getElementById('btn-register').classList.add('hidden');
                document.getElementById('group-username').classList.add('hidden');
                document.getElementById('text-switch').innerText = "Ch∆∞a c√≥ t√†i kho·∫£n?";

                document.getElementById('reg-email').id = 'login-email';
                document.getElementById('reg-password').id = 'login-password';
            }
        }
    </script>
</body>
</html>